"use strict";(self["webpackChunkweek7"]=self["webpackChunkweek7"]||[]).push([[808],{1530:function(t,e,a){function l(t){return{all:t=t||new Map,on:function(e,a){var l=t.get(e);l?l.push(a):t.set(e,[a])},off:function(e,a){var l=t.get(e);l&&(a?l.splice(l.indexOf(a)>>>0,1):t.set(e,[]))},emit:function(e,a){var l=t.get(e);l&&l.slice().map((function(t){t(a)})),(l=t.get("*"))&&l.slice().map((function(t){t(e,a)}))}}}a.d(e,{Z:function(){return o}});const s=l();var o=s},7808:function(t,e,a){a.r(e),a.d(e,{default:function(){return Ft}});var l=a(6252),s=a(3577),o=a(9963);const d={class:"container"},i={class:"mt-4"},r={class:"table align-middle"},n=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"圖片"),(0,l._)("th",null,"商品名稱"),(0,l._)("th",null,"價格"),(0,l._)("th")])],-1),c={style:{width:"200px"}},u={key:0,class:"h5"},m={key:1},p={class:"h6"},h={class:"h5"},_={class:"btn-group btn-group-sm"},b=["disabled","onClick"],g=["onClick","disabled"],v={class:"spinner-border spinner-border-sm"},f=(0,l.Uk)(" 加到購物車 "),y={class:"text-end"},w=["disabled"],C={class:"table align-middle"},k=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th"),(0,l._)("th",null,"品名"),(0,l._)("th",{style:{width:"150px"}},"數量/單位"),(0,l._)("th",null,"單價")])],-1),x=["onClick"],z={class:"input-group input-group-sm"},I={class:"input-group mb-3"},M=["onUpdate:modelValue","onChange","disabled"],D=["value"],V={class:"input-group-text",id:"basic-addon2"},$={class:"text-end"},q=(0,l._)("td",{colspan:"3",class:"text-end"},"總計",-1),L={class:"text-end"},U={class:"my-5 row justify-content-center"},W={class:"mb-3"},P=(0,l._)("label",{for:"email",class:"form-label"},"Email",-1),T={class:"mb-3"},F=(0,l._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),H={class:"mb-3"},Y=(0,l._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),Z={class:"mb-3"},E=(0,l._)("label",{for:"address",class:"form-label"},"收件人地址",-1),K={class:"mb-3"},O=(0,l._)("label",{for:"message",class:"form-label"},"留言",-1),j=(0,l._)("div",{class:"text-end"},[(0,l._)("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function A(t,e,a,A,S,B){const N=(0,l.up)("product-modal"),G=(0,l.up)("v-field"),J=(0,l.up)("error-message"),Q=(0,l.up)("v-form");return(0,l.wg)(),(0,l.iD)("div",d,[(0,l._)("div",i,[(0,l.Wm)(N,{id:S.productId,ref:"productModal",onAddCart:B.addToCart},null,8,["id","onAddCart"]),(0,l._)("table",r,[n,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(S.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",c,[(0,l._)("div",{style:(0,s.j5)([{backgroundImage:`url(${t.imageUrl})`},{height:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,l._)("td",null,(0,s.zw)(t.title),1),(0,l._)("td",null,[t.price===t.origin_price?((0,l.wg)(),(0,l.iD)("div",u,(0,s.zw)(t.price)+" 元 ",1)):((0,l.wg)(),(0,l.iD)("div",m,[(0,l._)("del",p,"原價 "+(0,s.zw)(t.origin_price)+" 元",1),(0,l._)("div",h,"現在只要 "+(0,s.zw)(t.price)+" 元",1)]))]),(0,l._)("td",null,[(0,l._)("div",_,[(0,l._)("button",{type:"button",class:"btn btn-outline-secondary",disabled:S.isLoadingItem===t.id,onClick:e=>B.openProductModal(t.id)}," 查看更多 ",8,b),(0,l._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e=>B.addToCart(t.id),disabled:S.isLoadingItem===t.id},[(0,l.wy)((0,l._)("span",v,null,512),[[o.F8,S.isLoadingItem===t.id]]),f],8,g)])])])))),128))])]),(0,l._)("div",y,[(0,l._)("button",{class:"btn btn-outline-danger",type:"button",onClick:e[0]||(e[0]=(...t)=>B.removeCartItems&&B.removeCartItems(...t)),disabled:0===S.cartData.carts.length}," 清空購物車 ",8,w)]),(0,l._)("table",C,[k,(0,l._)("tbody",null,[S.cartData.carts?((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(S.cartData.carts,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,[(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>B.removeCartItem(t.id)}," x ",8,x)]),(0,l._)("td",null,(0,s.zw)(t.product.title),1),(0,l._)("td",null,[(0,l._)("div",z,[(0,l._)("div",I,[(0,l.wy)((0,l._)("select",{id:"",class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>B.updateCart(t),disabled:S.isLoadingItem===t.id},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(20,(e=>(0,l._)("option",{value:e,key:`${e}-${t.id}`},(0,s.zw)(e),9,D))),64))],40,M),[[o.bM,t.qty]]),(0,l._)("span",V,(0,s.zw)(t.product.unit),1)])])]),(0,l._)("td",$,(0,s.zw)(t.total),1)])))),128)):(0,l.kq)("",!0)]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[q,(0,l._)("td",L,(0,s.zw)(S.cartData.total),1)])])]),(0,l._)("div",U,[(0,l.Wm)(Q,{ref:"form",class:"col-md-6",onSubmit:B.createOrder},{default:(0,l.w5)((({errors:t})=>[(0,l._)("div",W,[P,(0,l.Wm)(G,{id:"email",name:"email",type:"email",class:(0,s.C_)(["form-control",{"is-invalid":t["email"]}]),modelValue:S.form.user.email,"onUpdate:modelValue":e[1]||(e[1]=t=>S.form.user.email=t),placeholder:"請輸入 Email",rules:"email|required"},null,8,["modelValue","class"]),(0,l.Wm)(J,{name:"email",class:"invalid-feedback"})]),(0,l._)("div",T,[F,(0,l.Wm)(G,{id:"name",name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:S.form.user.name,"onUpdate:modelValue":e[2]||(e[2]=t=>S.form.user.name=t)},null,8,["class","modelValue"]),(0,l.Wm)(J,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",H,[Y,(0,l.Wm)(G,{id:"tel",name:"電話",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:S.form.user.tel,"onUpdate:modelValue":e[3]||(e[3]=t=>S.form.user.tel=t)},null,8,["class","modelValue"]),(0,l.Wm)(J,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",Z,[E,(0,l.Wm)(G,{id:"address",name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:S.form.user.address,"onUpdate:modelValue":e[4]||(e[4]=t=>S.form.user.address=t)},null,8,["class","modelValue"]),(0,l.Wm)(J,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",K,[O,(0,l.wy)((0,l._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[5]||(e[5]=t=>S.form.message=t)},null,512),[[o.nr,S.form.message]])]),j])),_:1},8,["onSubmit"])])])])}var S=a(1530),B=a(2954);const N={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},G={class:"modal-dialog modal-xl",role:"document"},J={class:"modal-content border-0"},Q={class:"modal-header bg-dark text-white"},R={class:"modal-title",id:"exampleModalLabel"},X=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),tt={class:"modal-body"},et={class:"row"},at={class:"col-sm-6"},lt=["src"],st={class:"col-sm-6"},ot={class:"badge bg-primary rounded-pill"},dt={key:0,class:"h5"},it={key:1},rt={class:"h6"},nt={class:"h5"},ct={class:"input-group"},ut={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},mt={class:"modal-dialog modal-xl",role:"document"},pt={class:"modal-content border-0"},ht={class:"modal-header bg-dark text-white"},_t={class:"modal-title",id:"exampleModalLabel"},bt=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),gt={class:"modal-body"},vt={class:"row"},ft={class:"col-sm-6"},yt=["src"],wt={class:"col-sm-6"},Ct={class:"badge bg-primary rounded-pill"},kt={key:0,class:"h5"},xt={key:1},zt={class:"h6"},It={class:"h5"},Mt={class:"input-group"};function Dt(t,e,a,d,i,r){return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",N,[(0,l._)("div",G,[(0,l._)("div",J,[(0,l._)("div",Q,[(0,l._)("h5",R,[(0,l._)("span",null,(0,s.zw)(i.product.title),1)]),X]),(0,l._)("div",tt,[(0,l._)("div",et,[(0,l._)("div",at,[(0,l._)("img",{class:"img-fluid",src:i.product.imageUrl,alt:""},null,8,lt)]),(0,l._)("div",st,[(0,l._)("span",ot,(0,s.zw)(i.product.category),1),(0,l._)("p",null,"商品描述："+(0,s.zw)(i.product.content),1),(0,l._)("p",null,"商品內容："+(0,s.zw)(i.product.description),1),i.product.price===i.product.origin_price?((0,l.wg)(),(0,l.iD)("div",dt,(0,s.zw)(i.product.price)+" 元 ",1)):((0,l.wg)(),(0,l.iD)("div",it,[(0,l._)("del",rt,"原價 "+(0,s.zw)(i.product.origin_price)+" 元",1),(0,l._)("div",nt,"現在只要 "+(0,s.zw)(i.product.price)+" 元",1)])),(0,l._)("div",null,[(0,l._)("div",ct,[(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":e[0]||(e[0]=t=>i.qty=t)},null,512),[[o.nr,i.qty,void 0,{number:!0}]]),(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>r.addToCart&&r.addToCart(...t))}," 加入購物車 ")])])])])])])])],512),(0,l._)("div",ut,[(0,l._)("div",mt,[(0,l._)("div",pt,[(0,l._)("div",ht,[(0,l._)("h5",_t,[(0,l._)("span",null,(0,s.zw)(i.product.title),1)]),bt]),(0,l._)("div",gt,[(0,l._)("div",vt,[(0,l._)("div",ft,[(0,l._)("img",{class:"img-fluid",src:i.product.imageUrl,alt:""},null,8,yt)]),(0,l._)("div",wt,[(0,l._)("span",Ct,(0,s.zw)(i.product.category),1),(0,l._)("p",null,"商品描述："+(0,s.zw)(i.product.content),1),(0,l._)("p",null,"商品內容："+(0,s.zw)(i.product.description),1),i.product.price===i.product.origin_price?((0,l.wg)(),(0,l.iD)("div",kt,(0,s.zw)(i.product.price)+" 元 ",1)):((0,l.wg)(),(0,l.iD)("div",xt,[(0,l._)("del",zt,"原價 "+(0,s.zw)(i.product.origin_price)+" 元",1),(0,l._)("div",It,"現在只要 "+(0,s.zw)(i.product.price)+" 元",1)])),(0,l._)("div",null,[(0,l._)("div",Mt,[(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":e[2]||(e[2]=t=>i.qty=t)},null,512),[[o.nr,i.qty,void 0,{number:!0}]]),(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[3]||(e[3]=(...t)=>r.addToCart&&r.addToCart(...t))}," 加入購物車 ")])])])])])])])],512)],64)}var Vt=a(7424),$t=a.n(Vt),qt={props:["id"],template:"#userProductModal",data(){return{modal:{},product:{},qty:1}},watch:{id(){this.getProduct()}},methods:{openModal(){this.modal.show()},closeModal(){this.modal.hide()},getProduct(){this.$http.get(`https://vue3-course-api.hexschool.io/v2//api/ttest/product/${this.id}`).then((t=>{console.log(t),this.product=t.data.product}))},addToCart(){this.$emit("add-cart",this.product.id,this.qty)}},mounted(){this.modal=new($t())(this.$refs.modal)},emits:["add-cart"]},Lt=a(3744);const Ut=(0,Lt.Z)(qt,[["render",Dt]]);var Wt=Ut,Pt={data(){return{cartData:{carts:[]},form:{user:{name:"",email:"",tel:"",address:"",message:""}},products:[],product:{},productId:"",isLoadingItem:""}},components:{VForm:B.l0,VField:B.gN,ErrorMessage:B.Bc,ProductModal:Wt},methods:{getProducts(){this.$http.get("https://vue3-course-api.hexschool.io/v2//api/ttest/products/all").then((t=>{this.products=t.data.products}))},openProductModal(t){this.productId=t,this.$refs.productModal.openModal()},getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2//api/ttest/cart").then((t=>{this.cartData=t.data.data}))},addToCart(t,e=1){const a={product_id:t,qty:e};this.isLoadingItem=t,this.$http.post("https://vue3-course-api.hexschool.io/v2//api/ttest/cart",{data:a}).then((t=>{console.log(t),this.getCart(),this.$refs.productModal.closeModal(),this.isLoadingItem="",S.Z.emit("get-cart")})).catch((t=>{console.log(t.data)}))},removeCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2//api/ttest/cart/${t}`).then((t=>{this.getCart(),this.isLoadingItem=""}))},removeCartItems(){this.$http.delete("https://vue3-course-api.hexschool.io/v2//api/ttest/carts").then((()=>{this.getCart()})).catch((t=>{console.log(t)}))},updateCart(t){const e={product_id:t.product.id,qty:t.qty};this.isLoadingItem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2//api/ttest/cart/${t.id}`,{data:e}).then((t=>{console.log(t),this.getCart(),this.isLoadingItem=""}))},createOrder(){const t="https://vue3-course-api.hexschool.io/v2//api/ttest/order",e=this.form;this.$http.post(t,{data:e}).then((t=>{console.log(t),alert(t.data.message),this.$refs.form.resetForm(),this.form.message="",this.getCart()})).catch((t=>{alert(t.data.message)}))}},mounted(){this.getProducts(),this.getCart()}};const Tt=(0,Lt.Z)(Pt,[["render",A]]);var Ft=Tt}}]);
//# sourceMappingURL=808.edd7cf0a.js.map