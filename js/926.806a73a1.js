"use strict";(self["webpackChunkweek7"]=self["webpackChunkweek7"]||[]).push([[926],{1926:function(t,e,l){l.r(e),l.d(e,{default:function(){return Yt}});var a=l(6252),d=l(3577),s=l(9963);const o={class:"container"},r={class:"table mt-4"},n=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"購買時間"),(0,a._)("th",null,"Email"),(0,a._)("th",null,"購買款項"),(0,a._)("th",null,"應付金額"),(0,a._)("th",null,"是否付款"),(0,a._)("th",null,"編輯")])],-1),i=["textContent"],u={class:"list-unstyled"},c={class:"text-right"},p={class:"form-check form-switch"},h=["id","onUpdate:modelValue","onChange"],_=["for"],m={key:0},b={key:1},g={class:"btn-group"},w=["onClick"],k=["onClick"];function y(t,e,l,y,v,f){const O=(0,a.up)("pagination"),M=(0,a.up)("order-modal"),x=(0,a.up)("del-order-modal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[(0,a._)("table",r,[n,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.orders,(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e.id},[v.orders.length?((0,a.wg)(),(0,a.iD)("tr",{key:0,class:(0,d.C_)({"text-secondary":!e.is_paid})},[(0,a._)("td",null,(0,d.zw)(e.create_at),1),(0,a._)("td",null,[e.user?((0,a.wg)(),(0,a.iD)("span",{key:0,textContent:(0,d.zw)(e.user.email)},null,8,i)):(0,a.kq)("",!0)]),(0,a._)("td",null,[(0,a._)("ul",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.products,((t,e)=>((0,a.wg)(),(0,a.iD)("li",{key:e},(0,d.zw)(t.product.title)+" 數量："+(0,d.zw)(t.qty)+" "+(0,d.zw)(t.product.unit),1)))),128))])]),(0,a._)("td",c,(0,d.zw)(e.total),1),(0,a._)("td",null,[(0,a._)("div",p,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${e.id}`,"onUpdate:modelValue":t=>e.is_paid=t,onChange:l=>t.updatePaid(e)},null,40,h),[[s.e8,e.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`paidSwitch${e.id}`},[e.is_paid?((0,a.wg)(),(0,a.iD)("span",m,"已付款")):((0,a.wg)(),(0,a.iD)("span",b,"未付款"))],8,_)])]),(0,a._)("td",null,[(0,a._)("div",g,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:t=>f.openModal(e)}," 檢視 ",8,w),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:t=>f.openDelOrderModal(e)}," 刪除 ",8,k)])])],2)):(0,a.kq)("",!0)],64)))),128))])]),(0,a.Wm)(O,{pages:v.pagination,onGetOrder:f.getOrders},null,8,["pages","onGetOrder"])]),(0,a.Wm)(M,{"temp-order":v.tempOrder,onGetOrders:f.getOrders,ref:"orderModal"},null,8,["temp-order","onGetOrders"]),(0,a.Wm)(x,{"temp-order":v.tempOrder,onGetOrders:f.getOrders,ref:"delOrderModal"},null,8,["temp-order","onGetOrders"])],64)}const v={"aria-label":"Page navigation example"},f={class:"pagination"},O=(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous"},[(0,a._)("span",{"aria-hidden":"true"},"«")],-1),M=[O],x=["onClick"],D=(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next"},[(0,a._)("span",{"aria-hidden":"true"},"»")],-1),C=[D];function z(t,e,l,o,r,n){return(0,a.wg)(),(0,a.iD)("nav",v,[(0,a._)("ul",f,[(0,a._)("li",{class:(0,d.C_)(["page-item",{disabled:!l.pages.has_pre}])},M,2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:(0,d.C_)(["page-item",{active:e===l.pages.current_page}]),key:e+"page"},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((l=>t.$emit("get-order",e)),["prevent"])},(0,d.zw)(e),9,x)],2)))),128)),(0,a._)("li",{class:(0,d.C_)(["page-item",{disabled:!l.pages.has_next}])},C,2)])])}var $={props:["pages"]},P=l(3744);const G=(0,P.Z)($,[["render",z]]);var H=G;const L={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"orderModal"},Y={class:"modal-dialog modal-xl",role:"document"},q={class:"modal-content border-0"},K=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"訂單細節")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Z={class:"modal-body"},E={class:"row"},U={class:"col-md-4"},V=(0,a._)("h3",null,"用戶資料",-1),W={class:"table"},F={key:0},S=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),j=(0,a._)("th",null,"Email",-1),A=(0,a._)("th",null,"電話",-1),N=(0,a._)("th",null,"地址",-1),T={class:"col-md-8"},B=(0,a._)("h3",null,"訂單細節",-1),I={class:"table"},J=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),Q=(0,a._)("th",null,"下單時間",-1),R=(0,a._)("th",null,"付款時間",-1),X={key:0},tt={key:1},et=(0,a._)("th",null,"付款狀態",-1),lt={key:0,class:"text-success"},at={key:1,class:"text-muted"},dt=(0,a._)("th",null,"總金額",-1),st=(0,a._)("h3",null,"選購商品",-1),ot={class:"table"},rt=(0,a._)("thead",null,[(0,a._)("tr")],-1),nt={class:"text-end"},it={class:"d-flex justify-content-end"},ut={class:"form-check"},ct={class:"form-check-label",for:"flexCheckDefault"},pt={key:0},ht={key:1},_t={class:"modal-footer"},mt=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function bt(t,e,l,o,r,n){return(0,a.wg)(),(0,a.iD)("div",L,[(0,a._)("div",Y,[(0,a._)("div",q,[K,(0,a._)("div",Z,[(0,a._)("div",E,[(0,a._)("div",U,[V,(0,a._)("table",W,[r.product.user?((0,a.wg)(),(0,a.iD)("tbody",F,[(0,a._)("tr",null,[S,(0,a._)("td",null,(0,d.zw)(r.product.user.name),1)]),(0,a._)("tr",null,[j,(0,a._)("td",null,(0,d.zw)(r.product.user.email),1)]),(0,a._)("tr",null,[A,(0,a._)("td",null,(0,d.zw)(r.product.user.tel),1)]),(0,a._)("tr",null,[N,(0,a._)("td",null,(0,d.zw)(r.product.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",T,[B,(0,a._)("table",I,[(0,a._)("tbody",null,[(0,a._)("tr",null,[J,(0,a._)("td",null,(0,d.zw)(r.product.id),1)]),(0,a._)("tr",null,[Q,(0,a._)("td",null,(0,d.zw)(r.product.create_at),1)]),(0,a._)("tr",null,[R,(0,a._)("td",null,[r.product.paid_date?((0,a.wg)(),(0,a.iD)("span",X,(0,d.zw)(r.product.paid_date),1)):((0,a.wg)(),(0,a.iD)("span",tt,"時間不正確"))])]),(0,a._)("tr",null,[et,(0,a._)("td",null,[r.product.is_paid?((0,a.wg)(),(0,a.iD)("strong",lt,"已付款")):((0,a.wg)(),(0,a.iD)("span",at,"尚未付款"))])]),(0,a._)("tr",null,[dt,(0,a._)("td",null,(0,d.zw)(r.product.total),1)])])]),st,(0,a._)("table",ot,[rt,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.product.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("th",null,(0,d.zw)(t.product.title),1),(0,a._)("td",null,(0,d.zw)(t.qty)+" / "+(0,d.zw)(t.product.unit),1),(0,a._)("td",nt,(0,d.zw)(t.final_total),1)])))),128))])]),(0,a._)("div",it,[(0,a._)("div",ut,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":e[0]||(e[0]=t=>r.product.is_paid=t)},null,512),[[s.e8,r.product.is_paid]]),(0,a._)("label",ct,[r.product.is_paid?((0,a.wg)(),(0,a.iD)("span",pt,"已付款")):((0,a.wg)(),(0,a.iD)("span",ht,"未付款"))])])])])])]),(0,a._)("div",_t,[mt,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>n.updateProduct&&n.updateProduct(...t))}," 修改付款狀態 ")])])])],512)}var gt=l(7424),wt=l.n(gt),kt={props:["tempOrder"],template:"#templateForProductModal",data(){return{product:{},bsModal:{}}},watch:{tempOrder(){this.product=this.tempOrder}},methods:{updateProduct(){const t=`https://vue3-course-api.hexschool.io/v2/api/ttest/admin/order/${this.tempOrder.id}`;this.$http.put(t,{data:this.tempOrder}).then((t=>{console.log(t),this.$emit("get-orders"),this.bsModal.hide()}))}},mounted(){this.bsModal=new(wt())(this.$refs.orderModal)}};const yt=(0,P.Z)(kt,[["render",bt]]);var vt=yt;const ft={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},Ot={class:"modal-dialog"},Mt={class:"modal-content border-0"},xt=(0,a.uE)('<div class="modal-header bg-danger text-white"><h5 id="delOrderModalLabel" class="modal-title"><span>刪除訂單</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><strong class="text-danger"> 是否刪除此筆訂單(刪除後將無法恢復)。</strong></div>',2),Dt={class:"modal-footer"},Ct=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function zt(t,e,l,d,s,o){return(0,a.wg)(),(0,a.iD)("div",ft,[(0,a._)("div",Ot,[(0,a._)("div",Mt,[xt,(0,a._)("div",Dt,[Ct,(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>o.delProduct&&o.delProduct(...t))}," 確認刪除 ")])])])],512)}var $t={props:["tempOrder"],template:"#templateForDelProductModal",methods:{data(){return{product:{},bsModal:{}}},delProduct(){const t=`https://vue3-course-api.hexschool.io/v2/api/ttest/admin/order/${this.tempOrder.id}`;this.$http.delete(t).then((t=>{console.log(t),this.$emit("get-orders"),this.bsModal.hide()}))}},mounted(){this.bsModal=new(wt())(this.$refs.delOrderModal)}};const Pt=(0,P.Z)($t,[["render",zt]]);var Gt=Pt,Ht={components:{pagination:H,orderModal:vt,delOrderModal:Gt},data(){return{orders:[],tempOrder:{},pagination:{}}},methods:{checkLogin(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common["Authorization"]=t;const e="https://vue3-course-api.hexschool.io/v2/api/user/check";this.$http.post(e).then((()=>{this.getOrders()}))},getOrders(t=1){const e=`https://vue3-course-api.hexschool.io/v2/api/ttest/admin/orders/?page=${t}`;this.$http.get(e).then((t=>{this.orders=t.data.orders,this.pagination=t.data.pagination})).catch((t=>{console.log(t)}))},openModal(t){this.tempOrder={...t},this.$refs.orderModal.bsModal.show()},openDelOrderModal(t){this.tempOrder={...t},console.log(this.tempOrder.user.name),this.$refs.delOrderModal.bsModal.show()}},mounted(){this.checkLogin()}};const Lt=(0,P.Z)(Ht,[["render",y]]);var Yt=Lt}}]);
//# sourceMappingURL=926.806a73a1.js.map